---
title: "Conditions Contributing to Covid Deaths"
author: "Kotomi"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(tidyverse)
library(janitor)
```
```{r}
options(scipen=999)
```


```{r}
conditions <- read.csv("data/conditions_clean.csv")
```

```{r}
glimpse(conditions)
```

```{r}
unique(conditions$condition_group)
```
```{r}
unique(conditions$condition)
```
```{r}
unique(conditions$age_group)
```


Compare number of deaths associated with each condition group. Separate by age group. *faceting doesn't look great for this so I will make individual plots
```{r}
conditions %>% 
  filter(group=="By Total"& state=="United States" & age_group=="0-24" & 
           condition_group != "COVID-19" & 
           condition_group!="All other conditions and causes (residual)" & 
           condition_group!="Intentional and unintentional injury, poisoning, and other adverse events") %>% 
  #filtered several conditions out bc i think it would be best to focus on non-COVID health conditions. it also simplifies the plot
  group_by(condition_group, age_group) %>% 
  summarise(total_deaths=sum(covid_19_deaths),
            .groups = "keep") %>% 
  ggplot(aes(x=reorder(condition_group, total_deaths), y=total_deaths))+
  geom_col()+
  theme_linedraw()+
  coord_flip()+
  labs(title = "Conditions Groups Contributing to COVID-19 Deaths, Ages 0-24 years",
       x = "Condition Group",
       y = "Associated Deaths")+
  theme(title = element_text(size = rel(0.8), hjust = 0.5))
```

```{r}
conditions %>% 
  filter(group=="By Total"& state=="United States" & age_group=="25-34" & 
           condition_group != "COVID-19" & 
           condition_group!="All other conditions and causes (residual)" & 
           condition_group!="Intentional and unintentional injury, poisoning, and other adverse events") %>% 
  group_by(condition_group, age_group) %>% 
  summarise(total_deaths=sum(covid_19_deaths),
            .groups = "keep") %>% 
  ggplot(aes(x=reorder(condition_group, total_deaths), y=total_deaths))+
  geom_col()+
  theme_linedraw()+
  coord_flip()+
  labs(title = "Conditions Groups Contributing to COVID-19 Deaths, Ages 25-34 years",
       x = "Condition Group",
       y = "Associated Deaths")+
  theme(title = element_text(size = rel(0.8), hjust = 0.5))
```

```{r}
conditions %>% 
  filter(group=="By Total"& state=="United States" & age_group=="35-44" & 
           condition_group != "COVID-19" & 
           condition_group!="All other conditions and causes (residual)" & 
           condition_group!="Intentional and unintentional injury, poisoning, and other adverse events") %>% 
  group_by(condition_group, age_group) %>% 
  summarise(total_deaths=sum(covid_19_deaths),
            .groups = "keep") %>% 
  ggplot(aes(x=reorder(condition_group, total_deaths), y=total_deaths))+
  geom_col()+
  theme_linedraw()+
  coord_flip()+
  labs(title = "Conditions Groups Contributing to COVID-19 Deaths, Ages 35-44 years",
       x = "Condition Group",
       y = "Associated Deaths")+
  theme(title = element_text(size = rel(0.8), hjust = 0.5))
```







